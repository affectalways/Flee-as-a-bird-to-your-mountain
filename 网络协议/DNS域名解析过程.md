# DNS域名解析过程

#### 目录

- [DNS域名解析步骤](#DNS域名解析步骤)



</br></br>

对于每一个HTTP请求发起过程中，都有很重要的一个步骤——DNS解析，本篇文章将跟着DNS解析过程来分析域名是如何解析的。



</br></br>

### DNS域名解析步骤

下图是域名解析的一个示例图，它涵盖了基本解析步骤和原理。

- 浏览器 DNS 缓存
- 系统 DNS 缓存
- 本地 DNS 服务器
- 根 DNS 服务器
- 顶级 DNS 服务器
- 域名 DNS 服务器

![](D:\git_code\Flee-as-a-bird-to-your-mountain\网络协议\pictures\域名解析1.png)



当用户在地址栏键入并敲下回车键之后，域名解析就开始了。

</br>

##### 1.检查浏览器缓存中是否缓存过该域名对应的IP地址

用户通过浏览器浏览过某网站之后，浏览器就会自动缓存该网站域名对应的地址，当用户再次访问的时候，浏览器就会从缓存中查找该域名对应的IP地址，因为缓存有时间限制（域名被缓存的时间通过属性来设置），所以存在域名对应的找不到的情况。

当浏览器从缓存中找到了该网站域名对应的地址，那么整个解析过程结束，如果没有找到，将进行下一步骤。

</br>

##### 2.如果在浏览器缓存中没有找到IP，那么将继续查找本机系统是否缓存过IP

如果第一个步骤没有完成对域名的解析过程，那么浏览器会去系统缓存中查找系统是否缓存过这个域名对应的地址，也可以理解为系统自己也具备域名解析的基本能力。

> 黑客可以将用户访问的域名绑定到他指定的系统上，从而实现了本地解析，导致这些域名被劫持。

前两步都是在本机上完成的，所以没有在上面示例图上展示出来，从第三步开始，才正在地向远程DNS服务器发起解析域名的请求。

</br>

##### 3.向本地域名解析服务系统发起域名解析的请求

如果在本机上无法完成域名的解析，那么系统只能请求本地域名解析服务系统进行解析，本地域名系统一般都是本地区的域名服务器，比如你连接的校园网，那么域名解析系统就在你的校园机房里，如果你连接的是电信、移动或者联通的网络，那么本地域名解析服务器就在本地区，由各自的运营商来提供服务。

</br>

##### 4.向根域名解析服务器发起域名解析请求

本地域名解析器还没有完成解析的话，那么本地域名解析服务器将向根域名服务器发起解析请求。

</br>

##### 5.根域名服务器返回顶级域名解析服务器地址

本地域名解析向根域名服务器发起解析请求，根域名服务器返回的是顶级域地址

</br>

##### 6.向顶级域名服务器发起解析请求

本地域名解析服务器向顶级域名服务器发起请求。

</br>

##### 7.顶级域名服务器接收请求并返回 域名DNS服务器

服务器接收本地域名服务器发起的请求，并根据需要解析的域名，找到该域名对应的域名服务器，通常情况下，这个服务器就是你注册的域名服务器，那么你注册的域名的服务商的服务器将承担起域名解析的任务。

</br>

##### 8.域名DNS服务器返回IP地址给本地服务器

服务器查找域名对应的地址，将地址连同值返回给本地域名服务器。

</br>

##### 9.本地域名服务器缓存解析结果

本地域名服务器缓存解析后的结果，缓存时间由时间来控制。

</br>

##### 10.返回解析结果给用户

解析结果将直接返回给用户，用户系统将缓存该地址，缓存时间由来控制，至此，解析过程结束。



</br></br>

#### 参考链接

- https://cloud.tencent.com/developer/news/324975