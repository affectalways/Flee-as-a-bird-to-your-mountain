### <u>InnoDB简介</u>

#### 快速认识InnoDB

InnoDB是MySQL的默认引擎。

1. 支持ACID，简单地说就是支持事务完整性、一致性；
2. 支持行锁，多用户并发；
3. 独有的聚集索引主键设计方式，可大幅提升并发读写性能；
4. 支持外键；
5. 支持崩溃数据自修复；

#### 



#### 使用InnoDB的好处

1. 如果服务器意外退出，无论当时数据库中发生了什么，重新启动数据库后都不需要执行任何特殊操作。InnoDB`崩溃恢复`会自动完成**崩溃之前已提交**的所有更改，并撤消所有**正在处理但尚未提交**的更改。只需重新启动并从上次中断的地方继续即可。
2. InnoDB存储引擎有自己的`缓冲池`，在访问数据时可以在主存中缓存**表**和**索引数据**。经常使用的数据直接从**内存**中处理。此缓存适用于许多类型的信息，并加快处理速度。在专用数据库服务器上，通常会将高达**80%**的物理内存分配给缓冲池。
3. 如果将相关数据分割到不同的表中，则可以设置执行参照完整性的`外键`。更新或删除数据，其他表中的相关数据将**自动**更新或删除。如果尝试将数据插入到一个辅助表中，而主表中没有相应的数据，那么**错误的数据将自动被踢出**。
4. 当您为每个表使用适当的`主键`列设计数据库时，涉及这些列的操作将**自动优化**。在**WHERE**子句、**ORDER BY**子句、**GROUP BY**子句和**join操作**中引用主键列非常快。
5. 插入、更新和删除由一种称为`change buffering`的自动机制进行优化。InnoDB不仅允许对同一个表并发读和写访问，它还**缓存修改后的数据**以简化磁盘I/O。
6. `自适应哈希索引`。当从一个表中一遍又一遍访问相同的数据时，InnoDB会自动对这些数据建立自适应哈希索引，就像从哈希表中查出来一样。
7. InnoDB是为处理大数据量时的CPU效率和最高性能而设计的。
8. InnoDB表可以处理大量数据，即使是在文件大小限制在2GB的操作系统上。





#### 如何使InnoDB性能更高

1. 为每个表中查询最频繁的一列或几列指定一个主键，如果没有明显的主键，则指定一个**自动递增的值**。
2. 使用join连接从多个表中根据相同的ID值提取数据时，为了提高连接性能，可以在连接列上定义`外键`，并在每个表中使用**相同的数据类型**声明这些列。**添加外键可以确保引用的列被索引**，这可以提高性能。外键还将**删除**或**更新**传播到所有受影响的表，并防止在父表中没有对应id的情况下在子表中插入数据。
3. 关闭`自动提交`。每秒提交数百次会限制性能(受存储设备的写入速度限制)。
4. 通过使用`START TRANSACTION`和`COMMIT`语句将相关的DML操作sql分组到事务中。不建议过于频繁地提交，也不建议发出一个批次中含有大量的INSERT、UPDATE或DELETE语句，这些语句可能运行几个小时。
5. 不建议使用`LOCK TABLES` 语句。`InnoDB`可以同时处理对同一个表进行读写的多个会话，而无需牺牲可靠性或高性能。要获得对一组行的排他性写访问权限，请使用 [`SELECT ... FOR UPDATE`](https://dev.mysql.com/doc/refman/5.7/en/innodb-locking-reads.html)语法仅锁定要更新的行。
6. 启用`innodb_file_per_table`选项，或者使用常规`表空间`将表的`数据`和`索引`放在**单独的文件**中，而不是`系统表空间`中。 默认情况下`innodb_file_per_table`选项是启用的。